<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pycheron.callPycheronMetric &#8212; Pycheron 2.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/horse-128.png"></span>
          Pycheron</a>
        <span class="navbar-text navbar-version pull-left"><b>2.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install.html">Install</a></li>
                <li><a href="../../pycheron.html">Documentation</a></li>
                <li><a href="https://gitlab.sandia.gov/lynm/pycheron">Gitlab</a></li>
                <li><a href="tutorials">Tutorials</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for pycheron.callPycheronMetric</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">fnmatch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.core.utcdatetime</span> <span class="k">import</span> <span class="n">UTCDateTime</span>
<span class="kn">from</span> <span class="nn">obspy.imaging.cm</span> <span class="k">import</span> <span class="n">pqlx</span>

<span class="kn">from</span> <span class="nn">pycheron.plotting.dailyPdfPlot</span> <span class="k">import</span> <span class="n">dailyPdfplots</span>
<span class="kn">from</span> <span class="nn">pycheron.plotting.psdPlot</span> <span class="k">import</span> <span class="n">psdPlot</span>
<span class="kn">from</span> <span class="nn">pycheron.plotting.rankingPlot</span> <span class="k">import</span> <span class="n">rankPlot</span>
<span class="kn">from</span> <span class="nn">pycheron.psd.noise.stationNoiseModel</span> <span class="k">import</span> <span class="n">stationNoiseModel</span>
<span class="kn">from</span> <span class="nn">pycheron.util.getChannel</span> <span class="k">import</span> <span class="n">getChannelName</span>
<span class="kn">from</span> <span class="nn">pycheron.util.getSta</span> <span class="k">import</span> <span class="n">getSta</span><span class="p">,</span> <span class="n">getUniqSta</span>
<span class="kn">from</span> <span class="nn">pycheron.psd.noise.networkNoiseModel</span> <span class="k">import</span> <span class="n">networkNoiseModel</span>
<span class="kn">from</span> <span class="nn">pycheron.dataAcq.css</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.basicStatsMetric</span> <span class="k">import</span> <span class="n">basicStatsMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.correlationMetric</span> <span class="k">import</span> <span class="n">correlationMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.crossCorrMetric</span> <span class="k">import</span> <span class="n">crossCorrMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.DCOffSetTimesMetric</span> <span class="k">import</span> <span class="n">DCOffSetTimesMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.gapMetric</span> <span class="k">import</span> <span class="n">gapMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.repeatedAmplitude</span> <span class="k">import</span> <span class="n">repeatedAmplitudeMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.deadChannelMetric</span> <span class="k">import</span> <span class="n">deadChannelMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.deadChanADFMetric</span> <span class="k">import</span> <span class="n">deadChanADFMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.deadChanMeanMetric</span> <span class="k">import</span> <span class="n">deadChanMean</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.snrMetric</span> <span class="k">import</span> <span class="n">snrMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.psdMetric</span> <span class="k">import</span> <span class="n">psdMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.sohMetric</span> <span class="k">import</span> <span class="n">sohMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.spikesMetric</span> <span class="k">import</span> <span class="n">spikesMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.staltaMetric</span> <span class="k">import</span> <span class="n">staltaMetric</span>
<span class="kn">from</span> <span class="nn">pycheron.metrics.calibration</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">metrics.transferFunctionMetric</span> <span class="k">import</span> <span class="n">transferFunctionMetric</span>
<span class="kn">import</span> <span class="nn">pycheron.util.logger</span> <span class="k">as</span> <span class="nn">Logger</span>
<span class="kn">from</span> <span class="nn">pycheron.db.sqllite_db</span> <span class="k">import</span> <span class="n">Database</span>

<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Process</span>


<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Pycheron Code</span>
<span class="c1"># -----------------------------------------------------------------------------</span>

<div class="viewcode-block" id="callPycheron"><a class="viewcode-back" href="../../pycheron.callPycheronMetric.html#pycheron.callPycheronMetric.callPycheron">[docs]</a><span class="k">def</span> <span class="nf">callPycheron</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;dir&quot;</span><span class="p">,</span> <span class="n">calcAll</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calcPsds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcBasic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcCorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">calcCrossCorr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">calcGap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcAmp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcSNR</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcSOH</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcStalta</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcDcOffset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">calcSpikes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcTransfer</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">calcCal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">byDay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">startdate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enddate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jul_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jul_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generateMasks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">rmsThreshold</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span>
                 <span class="n">maxThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">medianThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">stdThreshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">filt</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                 <span class="n">zerophase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">maxorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ba</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">freq_passband</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">windowSecs</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">separateMasks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">completeDay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">linLoPeriod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">evalresp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dcExpThreshold</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">dcLinThreshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_gaps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pctBelowNoiseThresholdRESP</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">minRep</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">algorithmSNR</span><span class="o">=</span><span class="s2">&quot;splitWindow&quot;</span><span class="p">,</span> <span class="n">windowSecsSNR</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data_quality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">activity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">io_clock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">windowSize</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">thresholdSpikes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">selectivity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">staSecs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                 <span class="n">ltaSecs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithmSTA</span><span class="o">=</span><span class="s2">&quot;classic_LR&quot;</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdfModel</span><span class="o">=</span><span class="s1">&#39;gsn&#39;</span><span class="p">,</span> <span class="n">per_arr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">showNoiseModel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showMode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showMean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showMedian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">showEnvelope</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">envelopeType</span><span class="o">=</span><span class="s2">&quot;10_90&quot;</span><span class="p">,</span> <span class="n">showSingle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">singleType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">min_stations</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rank_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">processesPSD</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="s2">&quot;pycheron.log&quot;</span><span class="p">,</span> <span class="n">fortran</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">timespan</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">dcADF_win_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">dcADF_use_thresh</span><span class="o">=</span><span class="s2">&quot;pvalue&quot;</span><span class="p">,</span>
                 <span class="n">dcMean_win_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                 <span class="n">dcLinThresholdHour</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">byHourOn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&quot;pycheron.db&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">to_csv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stationStartAt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pycheron wrapper script that runs the entire program. See the :doc:`../tutorials` for an in</span>
<span class="sd">    depth tutorial of usage.</span>

<span class="sd">    **General**</span>

<span class="sd">    :param output_dir: Path to location where top level &lt;network_dir&gt; will be saved</span>
<span class="sd">    :type output_dir: string</span>
<span class="sd">    :param data: Data to be processed. Currently supports:</span>

<span class="sd">                * MSEED: (str) Path to single .mseed file</span>
<span class="sd">                * Wfdisc: (str) Path to .wfdisc file</span>
<span class="sd">                * Stream: Obspy Stream Object</span>
<span class="sd">                * Directory: (str) Path to directory of multiple .mseed files. With filename format:</span>
<span class="sd">                             ``&lt;station&gt;_&lt;channel&gt;_&lt;julian day&gt;.mseed``. Use :doc:`../pycheron.util.format` to format</span>
<span class="sd">                             data correctly.</span>

<span class="sd">    :param datatype: The data type of parameter *data*.</span>

<span class="sd">                    * &quot;mseed&quot;: Use if *data* is single .mseed file</span>
<span class="sd">                    * &quot;stream&quot;: Use if *data* is Obspy Stream Object</span>
<span class="sd">                    * &quot;wfdisc&quot;: Use if *data* is path to .wfdisc file</span>
<span class="sd">                    * &quot;dir&quot;: Use if *data* is path to directory.</span>

<span class="sd">    :type datatype: str</span>
<span class="sd">    :param calcAll: Calculate all metrics. If set to False, individual metrics will be ran based on</span>
<span class="sd">                           parameters ``calc&lt;Metric&gt;``.</span>
<span class="sd">    :type calcAll: bool</span>
<span class="sd">    :param network: Network of stations. **Note:** Parameter required when using wfdic format.</span>
<span class="sd">    :type network: str</span>
<span class="sd">    :param station: Specify station to process. **Note:** Only used if parameter *data* is wfdisc format.</span>
<span class="sd">    :type station: str</span>
<span class="sd">    :param byDay: Split data up by days into Stream (1 stream/day). This is useful if you want to avoid computer</span>
<span class="sd">                  memory issues. Note: Only used if parameter *data* is wfdisc format or directory.</span>
<span class="sd">    :type byDay: bool</span>
<span class="sd">    :param startdate: Specific startdate. Used to slice Stream for specific time range. Format ``YYYY-MM-DD HH:MM:SS``</span>
<span class="sd">    :type startdate: str</span>
<span class="sd">    :param enddate: Specific startdate. Used to slice Stream for specific time range. Format ``YYYY-MM-DD HH:MM:SS``</span>
<span class="sd">    :type enddate: str</span>
<span class="sd">    :param jul_start: Julian start date of data. This is only used when parameter *datatype* is ``&quot;dir&quot;`` or. It will</span>
<span class="sd">                      speed up file aggregtion, instead of looping and searching through a range of 365. It can also be</span>
<span class="sd">                      used for when parameter *datatype* is ``&quot;wfdisc&quot;`` for selecting which date to start running on</span>
<span class="sd">                      for a specific station.</span>
<span class="sd">    :type jul_start: int</span>
<span class="sd">    :param jul_end: Julian end date of data. This is only used when parameter *datatype* is ``&quot;dir&quot;``. It will speed up</span>
<span class="sd">                    file aggregtion, instead of looping and searching through a range of 365.</span>
<span class="sd">    :type jul_end: int</span>
<span class="sd">    :param generateMasks: Generate QC Masks. If True, masks will be generated when a value exceeds threshold</span>
<span class="sd">                          parameters.</span>
<span class="sd">    :type generateMasks: bool</span>
<span class="sd">    :param masksByTime: If masks are generated, the output mask will be in time if True, else it will be a binary mask.</span>

<span class="sd">    :type masksByTime: bool</span>
<span class="sd">    :param log: If filename is input, then a logger will be output, (``Default = &quot;pycheron.log&quot;``)</span>
<span class="sd">    :type log: str</span>
<span class="sd">    :param fortran: Use Fortran libs or not. **Note:** If libs will not compile or on a Windows Machine, set to False.</span>
<span class="sd">    :type fortran: bool</span>
<span class="sd">    :param database: If database filename defined, a db will be created (``Default = &quot;pycheron.db&quot;``)</span>
<span class="sd">    :type database: str</span>
<span class="sd">    :param session: Session name in database. Used for grouping different runs/experiments (``Default = &quot;None&quot;``).</span>
<span class="sd">                    **Note:** the defualt is a String ``&quot;None&quot;``, not ``None`` (python Null). Do **NOT** set it</span>
<span class="sd">                    ``None`` (python Null), otherwise it will not be able to filter correctly.</span>
<span class="sd">    :type session: str</span>
<span class="sd">    :param overwrite: If set to True, entries of the same snclq and start/end time will be overwritten.</span>
<span class="sd">    :type overwrite: bool</span>
<span class="sd">    :param to_csv: If set to true, database will output to csv files.</span>
<span class="sd">    :type to_csv: bool</span>
<span class="sd">    :param stationStartAt: **WFDISC ONLY** Specify the station to start processing at, instead of at the beginning of</span>
<span class="sd">                           the wfidisc file.</span>
<span class="sd">    :type stationStartAt: str</span>

<span class="sd">    **basicMetricStats**</span>

<span class="sd">    :param calcBasic: Calculates basicStatsMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcBasic: bool</span>
<span class="sd">    :param rmsThreshold: QC Mask threshold for RMS in basicStats.</span>
<span class="sd">    :type rmsThreshold: int</span>
<span class="sd">    :param maxThreshold: QC Mask threshold for Max in basicStats.</span>
<span class="sd">    :type maxThreshold: int</span>
<span class="sd">    :param minThreshold: QC Mask threshold for Min in basicStats.</span>
<span class="sd">    :type minThreshold: int</span>
<span class="sd">    :param medianThreshold: QC Mask threshold for Median in basicStats.</span>
<span class="sd">    :type medianThreshold: int</span>
<span class="sd">    :param meanThreshold: QC Mask threshold for Mean in basicStats.</span>
<span class="sd">    :type meanThreshold: int</span>
<span class="sd">    :param varianceThreshold: QC Mask threshold for Variance in basicStats.</span>
<span class="sd">    :type varianceThreshold: int</span>
<span class="sd">    :param stdThreshold: QC Mask threshold for STD in basicStats.</span>
<span class="sd">    :type stdThreshold: int</span>

<span class="sd">    **correlationMetric**</span>

<span class="sd">    :param calcCorr: Calculates correlationMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcCorr: bool</span>

<span class="sd">    **Parameters for crossCorrMetric**</span>

<span class="sd">    :param calcCrossCorr: Calculates crossCorrelationMetric individually. **Note:** CalcAll must be set to ``False``.</span>

<span class="sd">    :type calcCrossCorr: bool</span>
<span class="sd">    :param maxLagSecs: Maximum number of seconds of lag to use in crossCorrMetric. (Default = 10)</span>
<span class="sd">    :type maxLagSecs: int</span>
<span class="sd">    :param filt: Filter to use in crossCorrMetric. Current supported filters:</span>

<span class="sd">                * bandpass</span>
<span class="sd">                * bandstop</span>
<span class="sd">                * enevelope</span>
<span class="sd">                * highpass</span>
<span class="sd">                * integer_decimation</span>
<span class="sd">                * lowpass</span>
<span class="sd">                * lowpass_cheby_2</span>

<span class="sd">                For more in-depth explaination of filters. Please see :doc:`../pycheron.metrics.crossCorrMetric`</span>
<span class="sd">    :type filt: str</span>
<span class="sd">    :param freqmin: Depending on the filter specified in parameter *filt* for crossCorrMetric, either pass band low</span>
<span class="sd">                    corner frequency (bandpass, bandstop), filter corner frequency (lowpass), or the frequency</span>
<span class="sd">                    above which signals are attenuated with 95 dB.</span>
<span class="sd">    :type freqmin: int</span>
<span class="sd">    :param freqmax: Depending on the filter specified in :param filt for crossCorrMetric, either passband high</span>
<span class="sd">                    corner frequency (bandpass, bandstop), or filter corner frequency (highpass)</span>
<span class="sd">    :type freqmax: int</span>
<span class="sd">    :param corners: Filter corners/order for crossCorrMetric.</span>
<span class="sd">    :type corners: int</span>
<span class="sd">    :param zerophase: If True, applies filter once forward and once backwards in crossCorrMetric. This results</span>
<span class="sd">                      in twice the filter order but zero phase shift in the resulting filtered trace.</span>

<span class="sd">    :type zerophase: bool</span>
<span class="sd">    :param maxorder: Maximal order of designed cheby2 filter in crossCorrMetric. **Note:** option for lowpass_cheby2</span>
<span class="sd">                     only.</span>
<span class="sd">    :type maxorder: int</span>
<span class="sd">    :param ba: If True, returns only the filter coefficients (b,a) instead of filtering. **Note:** option for</span>
<span class="sd">               lowpass_cheby2 only.</span>
<span class="sd">    :type ba: bool</span>
<span class="sd">    :param freq_passband: If True, return additionally to the filtered data, then iteratively determine the</span>
<span class="sd">                          pass band frequency. **Note:** option for lowpass_cheby2 only.</span>
<span class="sd">    :type freq_passband: bool</span>

<span class="sd">    **DCOffSetTimesMetric**</span>

<span class="sd">    :param calcDcOffset: Calculates DCOffSetTimesMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcDcOffset: bool</span>
<span class="sd">    :param windowSecs: Chunk size (secs) used in DCOffset calculations</span>
<span class="sd">    :type windowSecs: int</span>
<span class="sd">    :param incrementSecs: Increment (secs) for starttime of sequential chunks (Default = windowSecs/2)</span>
<span class="sd">    :type incrementSecs: int</span>
<span class="sd">    :param threshold: Threshold used in the detection metric</span>
<span class="sd">    :type threshold: int</span>

<span class="sd">    **gapMetric**</span>

<span class="sd">    :param calcGap: Calculates gapMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcGap: bool</span>
<span class="sd">    :param separateMasks: If True, 2 masks will be create. 1 for gaps, and 1 for overlaps, if False these masks</span>
<span class="sd">                          will be merged and 3 masks will be returned. Gaps, Overlaps, Combined.</span>
<span class="sd">    :type separateMasks: bool</span>
<span class="sd">    :param completeDay: If True, if an individual day is does not start at 00:00:00 or end at 23:59:59, a small</span>
<span class="sd">                        trace will be made to complete the day. This should be used if, for example, have only</span>
<span class="sd">                        6 hours of data, but would like to consider that 6 hours out of a whole day, thus gaps</span>
<span class="sd">                        would be found and masks would be created around that segment of data.</span>
<span class="sd">    :type completeDay: bool</span>

<span class="sd">    **psdMetric**</span>

<span class="sd">    :param calcPsds: Calculates PSDS individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcPsds: bool</span>
<span class="sd">    :param expLoPeriod: Low end of the period band used for calculating the exponential dead channel detector</span>
<span class="sd">                        (``Default= 4/trace sampling rate``)</span>
<span class="sd">    :type expLoPeriod: int</span>
<span class="sd">    :param expHiPeriod: High end of the period band used for calculating the exponential dead channel detector</span>
<span class="sd">    :type expHiPeriod: int</span>
<span class="sd">    :param linLoPeriod: Low end of the period band used for calculating the linear dead channel detector</span>
<span class="sd">                        (``Default= 16/trace sampling rate``)</span>
<span class="sd">    :type linLoPeriod: int</span>
<span class="sd">    :param linHiPeriod: High end of the period band used for calculating the linear dead channel detector</span>
<span class="sd">    :type linHiPeriod: int</span>
<span class="sd">    :param evalresp: Response information obtained from numpy.ndarray of freq, amp, phase information matching output</span>
<span class="sd">                     of ``client.evalresp``, optional for ``psdStatistics``. If ``None``, will pull from</span>
<span class="sd">                     ``client.evalresp``. Also accepts str path to RESP files</span>
<span class="sd">    :type evalresp: str or numpy.ndarray</span>
<span class="sd">    :param dcExpThreshold: Dead channel exponent threshold.</span>
<span class="sd">    :type dcExpThreshold: float</span>
<span class="sd">    :param pctBelowNoiseThreshold: Percent below NLNM threshold.</span>
<span class="sd">    :type pctBelowNoiseThreshold: int</span>
<span class="sd">    :param pctAboveNoiseThreshold: Percent above NLNM threshold.</span>
<span class="sd">    :type pctAboveNoiseThreshold: int</span>
<span class="sd">    :param dcLinThreshold: Dead channel linear threshold.</span>
<span class="sd">    :type dcLinThreshold: int</span>
<span class="sd">    :param num_gaps: Number of gaps threshold.</span>
<span class="sd">    :type num_gaps: int</span>
<span class="sd">    :param pctBelowNoiseThresholdRESP: Percent below NLNM for bad response threshold.</span>
<span class="sd">    :type pctBelowNoiseThresholdRESP: int</span>
<span class="sd">    :param pctAboveNoiseThresholdRESP: Percent above NLNM for bad response threshold.</span>
<span class="sd">    :type pctAboveNoiseThresholdRESP: int</span>
<span class="sd">    :param processesPSD: Number of processes to run. The max number of processes that can be run is</span>
<span class="sd">                         equal to the length of the Stream. Not recommended to go above 7 processes.</span>
<span class="sd">    :type processesPSD: int</span>
<span class="sd">    :param dcExpThresholdHour: dead channel exponent hourly threshold. Only used if ``byHourOn`` is ``True``</span>
<span class="sd">    :type dcExpThresholdHour: int</span>
<span class="sd">    :param dcLinThresholdHour: dead channel linear hourly threshold. Only used if ``byHouron`` set to ``True``</span>
<span class="sd">    :type dcLinThresholdHour: int</span>
<span class="sd">    :param byHourOn: Turn on hourly thresholding checks for ``dead_channel_exponential``, ``dead_channel_linear``,</span>
<span class="sd">                     and dead_channel_gsn checks</span>
<span class="sd">    :type byHourOn: bool</span>

<span class="sd">    **repeatedAmplitudeMetric**</span>

<span class="sd">    :param calcAmp: Calculates repeatedAmplitudeMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcAmp: bool</span>
<span class="sd">    :param minRep: minimum number of repeated adjacent values in a series, &gt; 1.</span>
<span class="sd">    :type minRep: int</span>

<span class="sd">    **snrMetric**</span>

<span class="sd">    :param calcSNR: (bool) Calculates snrMetric individually. **Note:** CalcAll must be set to ``False``. (Default = False)</span>
<span class="sd">    :type calcSNR: bool</span>
<span class="sd">    :param algorithmSNR: A named algorithm to use for calculating SNR. Options include:</span>

<span class="sd">                        * &#39;splitWindow&#39;</span>
<span class="sd">                        * &#39;staltaTrigger&#39;</span>
<span class="sd">                        * &#39;pick&#39;</span>

<span class="sd">                        Please see :doc:`../pycheron.metrics.snrMetric` for more detailed descriptions of algorithms.</span>
<span class="sd">    :type algorithmSNR: str</span>
<span class="sd">    :param windowSecsSNR: Width (secs) of the full window used in SNR calculation</span>
<span class="sd">    :type windowSecsSNR: int</span>
<span class="sd">    :param snrThreshold: SNR threshold at which if above, value would be masked.</span>
<span class="sd">    :type snrThreshold: int</span>

<span class="sd">    **sohMetric**</span>

<span class="sd">    :param calcSOH: Calculates sohMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcSOH: bool</span>
<span class="sd">    :param data_quality: If ``True``, only the data quality flags are returned.</span>
<span class="sd">    :type data_quality: bool</span>
<span class="sd">    :param activity: If ``True``, only the activity flags are returned.</span>
<span class="sd">    :type activity: bool</span>
<span class="sd">    :param io_clock: If ``True``, only the io/clock flags are returned.</span>
<span class="sd">    :type io_clock: bool</span>

<span class="sd">    **spikesMetric**</span>

<span class="sd">    :param calcSpikes: Calculates spikesMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcSpikes: bool</span>
<span class="sd">    :param windowSize: Size of window to be used (e.g., window size to roll over)</span>
<span class="sd">    :type windowSize: int</span>
<span class="sd">    :param thresholdSpikes: Initial threshold value for outlier detection</span>
<span class="sd">    :type thresholdSpikes: int</span>
<span class="sd">    :param selectivity: ``[0-1]`` Used in determining outliers, or ``None`` if ``fixedThreshold = True``</span>
<span class="sd">    :type selectivity: float</span>
<span class="sd">    :param fixedThreshold: If ``True``, set the threshold = threshold and ignore selectivity. If ``False``, then</span>
<span class="sd">                           the threshold is set to the maximum value of the hampel/hampelFilter function</span>
<span class="sd">                           output multiplied by the selectivity</span>
<span class="sd">    :type fixedThreshold: bool</span>
<span class="sd">    :param processesSpikes: Number of processes to bring up. Not recommended to go above 7 on personal machines.</span>
<span class="sd">    :type processesSpikes: int</span>

<span class="sd">    **staltaMetric**</span>

<span class="sd">    :param calcStalta: Calculates staltaMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcStalta: bool</span>
<span class="sd">    :param staSecs: Length of short term averaging window in secs</span>
<span class="sd">    :type staSecs: int</span>
<span class="sd">    :param ltaSecs: Length of long term averaging window in secs</span>
<span class="sd">    :type ltaSecs: int</span>
<span class="sd">    :param increment: Increment (in secs) used when sliding the average windows to the next location</span>
<span class="sd">    :type increment: int</span>
<span class="sd">    :param algorithmSTA: Algorithm to be used. Currently supported algorithms include (for more information see</span>
<span class="sd">                         references below and STALTA function docstrings):</span>

<span class="sd">                         * Classic_RR</span>
<span class="sd">                         * Classic_LR</span>
<span class="sd">                         * EarleAndShearer_envelope</span>

<span class="sd">    :type algorithmSTA: str</span>

<span class="sd">    **Parameters for deadChannelMetric**</span>

<span class="sd">    :param calcAllDeadChan: Calculates deadChannelMetric, deanChanADF, and deadChanMeanMetric individually.</span>
<span class="sd">                            **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcAllDeadChan: bool</span>

<span class="sd">    **deadChanADFMetric**</span>

<span class="sd">    :param dcADF_win_size: window size to increment the data by in samples, each window will have a ADF run on it</span>
<span class="sd">                           (``DEFAULT = 500``, assumes 100sps). If None, window size determined by sample rate of each</span>
<span class="sd">                           trace in the stream object</span>
<span class="sd">    :type dcADF_win_size: int</span>
<span class="sd">    :param dcADF_pval_thresh: p value threshold to trigger ADF rejection of null hypothesis (e.g., time series is</span>
<span class="sd">                              assumed stationary with rejection of null hypothesis)</span>
<span class="sd">    :type dcADF_pval_thresh: float</span>
<span class="sd">    :param dcADF_threshold: threshold to trigger ADF rejection of null hypothesis using difference between DF test statistic</span>
<span class="sd">                            and 1% critical value</span>
<span class="sd">    :type dcADF_threshold: float</span>
<span class="sd">    :param dcADF_use_thresh: String option for choosing whether to use the pvalue_threshold or the threshold for</span>
<span class="sd">                             determining whether null hypothesis fails (DEFAULT = pvalue). Options are pvalue or</span>
<span class="sd">                             diffs.</span>
<span class="sd">    :type dcADF_use_thresh: float</span>

<span class="sd">    **deadChanMeanMetric**</span>

<span class="sd">    :param dcMean_win_size: number of samples to use for windowing. When ``None``, determines the number</span>
<span class="sd">                            of samples to use based on the sample rate</span>
<span class="sd">    :type dcMean_win_size: int</span>
<span class="sd">    :param dcMean_thresh: threshold to trigger deadChan for within rolling window. Recommended</span>
<span class="sd">                          to keep this default value for triggered a dead channel</span>
<span class="sd">    :type dcMean_thresh: float</span>

<span class="sd">    **transferFunctionMetric**</span>

<span class="sd">    :param calcTransfer: Calculates transferFunctionMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcTransfer: bool</span>

<span class="sd">    **calibrationMetric**</span>

<span class="sd">    :param calcCal: Calculates scalibrationMetric individually. **Note:** CalcAll must be set to ``False``.</span>
<span class="sd">    :type calcCal: bool</span>
<span class="sd">    :param cal_metric_store: (Default = None)</span>

<span class="sd">    **plots**</span>

<span class="sd">    :param plots: (bool) If True, plots will be created. This will slow down the program considerably. It is</span>
<span class="sd">                         recommended to use the bulk plotting functions once calculations are complete.</span>
<span class="sd">    :type plots: bool</span>
<span class="sd">    :param pdfModel: Noise Model. Supports:</span>

<span class="sd">                     * ``&quot;gsn&quot;`` - Global Seismic Network 2004</span>
<span class="sd">                     * ``&quot;nlnm&quot;`` - New Low Noise Model</span>

<span class="sd">    :type pdfModel: str</span>
<span class="sd">    :param per_arr: Period array for PDF Mode Colorline plot. If none, periods will be:</span>
<span class="sd">                    ``[.1, 1.0, 6.5, 10, 30.8, 103.7]``.</span>
<span class="sd">    :type per_arr: numpy.array or list</span>
<span class="sd">    :param showNoiseModel: If ``True``, display noise models on the plot</span>
<span class="sd">    :type showNoiseModel: bool</span>
<span class="sd">    :param showMaxMin: If ``True``, display max and min on the plot</span>
<span class="sd">    :type showMaxMin: bool</span>
<span class="sd">    :param showMode: If ``True``, display mode on the plot</span>
<span class="sd">    :type showMode: bool</span>
<span class="sd">    :param showMean: If ``True``, display mean on the plot</span>
<span class="sd">    :type showMean: bool</span>
<span class="sd">    :param showMedian: If ``True``, display median on the plot</span>
<span class="sd">    :type showMedian: bool</span>
<span class="sd">    :param showEnvelope: If ``True``, percentile envelope will be plotted</span>
<span class="sd">    :type showEnvelope: bool</span>
<span class="sd">    :param envelopeType: Envelope to be plotted. Options:</span>

<span class="sd">                               * ``&quot;10_90&quot;`` - 10th and 90th percentile envelope</span>
<span class="sd">                               * ``&quot;05_95&quot;`` - 5th annd 95th percentile envelope</span>

<span class="sd">    :type envelopeType: bool</span>
<span class="sd">    :param showSingle: If ``True``, plot single percentile.</span>
<span class="sd">    :type showSingle: bool</span>
<span class="sd">    :param singleType: Single line percentile to be plotted. Options:</span>

<span class="sd">                             * ``&quot;5&quot;`` - 5th percentile</span>
<span class="sd">                             * ``&quot;10&quot;`` - 10th percentile</span>
<span class="sd">                             * ``&quot;90&quot;`` - 90th percentile</span>
<span class="sd">                             * ``&quot;95&quot;`` - 95th percentile</span>

<span class="sd">    :type singleType: bool</span>
<span class="sd">    :param min_stations: Minimum number of stations to have calculated before Station Ranking Plots will be</span>
<span class="sd">                         plotted.</span>
<span class="sd">    :type min_stations: int</span>
<span class="sd">    :param rank_by: Array of periods to rank by in Station Ranking Plots. If None, periods will be</span>
<span class="sd">                    ``[1, 6.5, 30, 100]``</span>
<span class="sd">    :type rank_by: numpy.array or list</span>
<span class="sd">    :param timespan: Select the timespan for psd/pdf plots. Options are ``1`` (week), ``2`` (weeks), ``4`` (weeks).</span>
<span class="sd">                     Any other option will defualt to plotting all psds (``Default=&quot;All&quot;``)</span>
<span class="sd">    :type timespan: int or string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">database</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">database</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>

    <span class="c1"># creating logger</span>
    <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># for single .mseed file</span>
    <span class="k">if</span> <span class="n">datatype</span> <span class="o">==</span> <span class="s2">&quot;mseed&quot;</span><span class="p">:</span>
        <span class="c1"># read in file</span>
        <span class="n">st_raw</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">)</span>
        <span class="c1"># set julday to &quot;All&quot;, means processing all data, not by individual days</span>
        <span class="n">julday</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
        <span class="c1"># getting all unique stations from Stream</span>
        <span class="n">un_sta</span> <span class="o">=</span> <span class="n">getUniqSta</span><span class="p">(</span><span class="n">st_raw</span><span class="p">)</span>
        <span class="c1"># looping through station list and calling metrics on each station</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">un_sta</span><span class="p">:</span>
            <span class="n">st_sta</span> <span class="o">=</span> <span class="n">getSta</span><span class="p">(</span><span class="n">st_raw</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                   <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                   <span class="n">calcDcOffset</span><span class="p">,</span>
                                   <span class="n">calcTransfer</span><span class="p">,</span>
                                   <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span><span class="p">,</span>
                                   <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                   <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                   <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                   <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                   <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                   <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                   <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span>
                                   <span class="n">num_gaps</span><span class="p">,</span>
                                   <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                   <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                   <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                   <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                   <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                   <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                   <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">timespan</span><span class="p">,</span>
                                   <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                   <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                   <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>

    <span class="c1"># for Obspy Stream object -&gt; mostly for SAPL integration</span>
    <span class="k">elif</span> <span class="n">datatype</span> <span class="o">==</span> <span class="s2">&quot;stream&quot;</span><span class="p">:</span>
        <span class="n">st_raw</span> <span class="o">=</span> <span class="n">data</span>
        <span class="c1"># set julday to &quot;All&quot;, means processing all data, not by individual days</span>
        <span class="n">julday</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
        <span class="c1"># getting all unique stations from Stream</span>
        <span class="n">un_sta</span> <span class="o">=</span> <span class="n">getUniqSta</span><span class="p">(</span><span class="n">st_raw</span><span class="p">)</span>
        <span class="c1"># looping through station list and calling metrics on each station</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">un_sta</span><span class="p">:</span>
            <span class="n">st_sta</span> <span class="o">=</span> <span class="n">getSta</span><span class="p">(</span><span class="n">st_raw</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                   <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                   <span class="n">calcDcOffset</span><span class="p">,</span>
                                   <span class="n">calcTransfer</span><span class="p">,</span>
                                   <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span><span class="p">,</span>
                                   <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                   <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                   <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                   <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                   <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                   <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                   <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span>
                                   <span class="n">num_gaps</span><span class="p">,</span>
                                   <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                   <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                   <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                   <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                   <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                   <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                   <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">timespan</span><span class="p">,</span>
                                   <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                   <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                   <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>

    <span class="c1"># for CSS/S4 Wfdisc file</span>
    <span class="k">elif</span> <span class="n">datatype</span> <span class="o">==</span> <span class="s2">&quot;wfdisc&quot;</span><span class="p">:</span>
        <span class="c1"># gets all unique stations from wfdisc file</span>
        <span class="n">un_sta</span> <span class="o">=</span> <span class="n">get_wfdisc_stations</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># if station not specified, process all stations in file</span>
        <span class="k">if</span> <span class="n">station</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">stationStartAt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">un_sta</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">stationStartAt</span><span class="p">)</span>
                <span class="n">un_sta</span> <span class="o">=</span> <span class="n">un_sta</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">un_sta</span><span class="p">:</span>
                <span class="c1"># convert waveform files into Obspy Stream objects</span>
                <span class="n">st_sta</span> <span class="o">=</span> <span class="n">css2stream</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">byDay</span><span class="p">)</span>
                <span class="c1"># if stream to be entire station</span>
                <span class="k">if</span> <span class="n">byDay</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">julday</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
                    <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                           <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                           <span class="n">calcDcOffset</span><span class="p">,</span>
                                           <span class="n">calcTransfer</span><span class="p">,</span>
                                           <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span>
                                           <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                           <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                           <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                           <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                           <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                           <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                           <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                                           <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span>
                                           <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                           <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                           <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                           <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                           <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                           <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                           <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span>
                                           <span class="n">timespan</span><span class="p">,</span>
                                           <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                           <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                           <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># if stream to be split up by days, loop through each day in stream</span>
                    <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">st_sta</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">jul_start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="o">.</span><span class="n">julday</span> <span class="o">&gt;=</span> <span class="n">jul_start</span><span class="p">:</span>
                            <span class="n">julday</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="o">.</span><span class="n">julday</span>
                            <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                                   <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span>
                                                   <span class="n">calcStalta</span><span class="p">,</span>
                                                   <span class="n">calcDcOffset</span><span class="p">,</span>
                                                   <span class="n">calcTransfer</span><span class="p">,</span>
                                                   <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span>
                                                   <span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                                   <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                                   <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span>
                                                   <span class="n">maxLagSecs</span><span class="p">,</span>
                                                   <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                                   <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                                   <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span>
                                                   <span class="n">evalresp</span><span class="p">,</span>
                                                   <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                                                   <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span>
                                                   <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span>
                                                   <span class="n">algorithmSNR</span><span class="p">,</span>
                                                   <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span>
                                                   <span class="n">windowSize</span><span class="p">,</span>
                                                   <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span>
                                                   <span class="n">increment</span><span class="p">,</span>
                                                   <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                                   <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                                   <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                                   <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                                                   <span class="n">fortran</span><span class="p">,</span>
                                                   <span class="n">timespan</span><span class="p">,</span>
                                                   <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                                   <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                                   <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
        <span class="c1"># if specific Station is specified</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># convert waveform file to Stream</span>
            <span class="n">st_sta</span> <span class="o">=</span> <span class="n">css2stream</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">byDay</span><span class="p">)</span>
            <span class="c1"># if stream to be entire station</span>
            <span class="k">if</span> <span class="n">byDay</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">julday</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span>
                <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                       <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                       <span class="n">calcDcOffset</span><span class="p">,</span>
                                       <span class="n">calcTransfer</span><span class="p">,</span>
                                       <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span>
                                       <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                       <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                       <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                       <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                       <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                       <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                       <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span>
                                       <span class="n">num_gaps</span><span class="p">,</span>
                                       <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                       <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                       <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                       <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                       <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                       <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                       <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">timespan</span><span class="p">,</span>
                                       <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                       <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                       <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
            <span class="c1"># if stream to be split up by days, loop through each day in stream</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">st_sta</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jul_start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="o">.</span><span class="n">julday</span> <span class="o">&gt;=</span> <span class="n">jul_start</span><span class="p">:</span>
                        <span class="n">julday</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="o">.</span><span class="n">julday</span>
                        <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                               <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                               <span class="n">calcDcOffset</span><span class="p">,</span>
                                               <span class="n">calcTransfer</span><span class="p">,</span>
                                               <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span>
                                               <span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                               <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                               <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span>
                                               <span class="n">maxLagSecs</span><span class="p">,</span>
                                               <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                               <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                               <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span>
                                               <span class="n">evalresp</span><span class="p">,</span>
                                               <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                                               <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span>
                                               <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span>
                                               <span class="n">algorithmSNR</span><span class="p">,</span>
                                               <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span>
                                               <span class="n">windowSize</span><span class="p">,</span>
                                               <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span>
                                               <span class="n">increment</span><span class="p">,</span>
                                               <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                               <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                               <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                               <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span>
                                               <span class="n">timespan</span><span class="p">,</span>
                                               <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                               <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                               <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">datatype</span> <span class="o">==</span> <span class="s2">&quot;dir&quot;</span><span class="p">:</span>
        <span class="c1"># create array of jul days</span>
        <span class="k">if</span> <span class="n">jul_start</span> <span class="ow">and</span> <span class="n">jul_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">date_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if jul date range is None, then process all of the files</span>
            <span class="n">date_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">366</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Convert julian days to real julian day numbers for those less than 100. The reason we do this is that</span>
        <span class="c1"># np.arange will not create an appropriate date_range if inputs are 001, 032 for example. So we take the user</span>
        <span class="c1"># input and convert to proper julian days so that we can ensure that the correct data files are being grabbed</span>
        <span class="n">new_dates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">date_range</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="s1">&#39;00&#39;</span> <span class="o">+</span> <span class="n">i</span>
                    <span class="n">new_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span class="o">+</span> <span class="n">i</span>
                    <span class="n">new_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="c1"># Create empty sta_list and chan_list for looping</span>
        <span class="n">sta_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">chan_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># looping through files</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># if file ends with jul date add to list</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mseed&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">i</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.w&quot;</span><span class="p">):</span>
                <span class="c1"># get station from name</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sta_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">chan_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># get unique stations</span>
        <span class="n">un_chans</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">chan_list</span><span class="p">)</span>
        <span class="n">un_chans</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">un_chans</span><span class="p">)</span>
        <span class="n">un_chans</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">un_sta</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sta_list</span><span class="p">)</span>
        <span class="n">un_sta</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">un_sta</span><span class="p">)</span>
        <span class="n">un_sta</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="c1"># aggregate all days of one station into single stream</span>
        <span class="k">if</span> <span class="n">byDay</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># looping through files</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">un_sta</span><span class="p">:</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">new_dates</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                        <span class="c1"># if i matches station</span>
                        <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="s1">&#39;.mseed&#39;</span><span class="p">):</span>
                            <span class="c1"># st filename of specific station</span>
                            <span class="n">st</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                            <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

                <span class="c1"># initialize first stream</span>
                <span class="n">st_sta</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">)):</span>
                        <span class="n">st_sta</span> <span class="o">=</span> <span class="n">st_sta</span> <span class="o">+</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="p">)[</span><span class="n">s</span><span class="p">])</span>
                <span class="nb">print</span> <span class="s2">&quot;Finished Aggregating Streams for: &quot;</span> <span class="o">+</span> <span class="n">i</span>
                <span class="n">julday</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span>
                <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                       <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                       <span class="n">calcDcOffset</span><span class="p">,</span>
                                       <span class="n">calcTransfer</span><span class="p">,</span>
                                       <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span>
                                       <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                       <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                       <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                       <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                       <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                       <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                       <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span>
                                       <span class="n">num_gaps</span><span class="p">,</span>
                                       <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                       <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                       <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                       <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                       <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                       <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                       <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">timespan</span><span class="p">,</span>
                                       <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                       <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                       <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
        <span class="c1"># process by individual day</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># loop through station</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">un_sta</span><span class="p">:</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">date_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">new_dates</span><span class="p">:</span>
                    <span class="n">day</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                        <span class="c1"># if i matches station</span>
                        <span class="k">if</span> <span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="s1">&#39;.mseed&#39;</span><span class="p">):</span>
                            <span class="c1"># st filename of specific station</span>
                            <span class="n">st</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                            <span class="n">day</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
                            <span class="n">date_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">day</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
                    <span class="n">date</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">date_list</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">day</span><span class="p">:</span>
                        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
                <span class="n">date</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">)):</span>
                    <span class="c1"># initialize first stream</span>
                    <span class="n">julday</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">files</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">st_sta</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
                            <span class="n">st_sta</span> <span class="o">=</span> <span class="n">st_sta</span> <span class="o">+</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">)[</span><span class="n">s</span><span class="p">])</span>
                    <span class="n">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                                           <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span>
                                           <span class="n">calcDcOffset</span><span class="p">,</span>
                                           <span class="n">calcTransfer</span><span class="p">,</span>
                                           <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span>
                                           <span class="n">jul_end</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                                           <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                                           <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                                           <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                           <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                                           <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                                           <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                                           <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span>
                                           <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                                           <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                                           <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                                           <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                                           <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                                           <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                                           <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span>
                                           <span class="n">timespan</span><span class="p">,</span>
                                           <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                                           <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span>
                                           <span class="n">dcLinThresholdHour</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">session</span><span class="p">)</span>
        <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Total program runtime in minutes - &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Must provide either .mseed, .wfdisc, stream object or data directory&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Must provide either .mseed, .wfdisc, stream object or data directory&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">to_csv</span><span class="p">:</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">+</span> <span class="s2">&quot;/pycheron&quot;</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Pycheron Wrapper Code</span>
<span class="c1"># -----------------------------------------------------------------------------</span>

<span class="k">def</span> <span class="nf">_call_pycheron_wrapper</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">st_sta</span><span class="p">,</span> <span class="n">calcAll</span><span class="p">,</span> <span class="n">calcPsds</span><span class="p">,</span> <span class="n">calcBasic</span><span class="p">,</span>
                           <span class="n">calcCorr</span><span class="p">,</span> <span class="n">calcCrossCorr</span><span class="p">,</span> <span class="n">calcGap</span><span class="p">,</span> <span class="n">calcAmp</span><span class="p">,</span> <span class="n">calcSNR</span><span class="p">,</span> <span class="n">calcSOH</span><span class="p">,</span> <span class="n">calcStalta</span><span class="p">,</span> <span class="n">calcDcOffset</span><span class="p">,</span>
                           <span class="n">calcTransfer</span><span class="p">,</span>
                           <span class="n">calcSpikes</span><span class="p">,</span> <span class="n">calcAllDeadChan</span><span class="p">,</span> <span class="n">calcCal</span><span class="p">,</span> <span class="n">julday</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">,</span> <span class="n">jul_start</span><span class="p">,</span> <span class="n">jul_end</span><span class="p">,</span>
                           <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span>
                           <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span>
                           <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span> <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span>
                           <span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                           <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                           <span class="n">separateMasks</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span> <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span>
                           <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span> <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span>
                           <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span>
                           <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span>
                           <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span>
                           <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                           <span class="n">showNoiseModel</span><span class="p">,</span> <span class="n">showMaxMin</span><span class="p">,</span> <span class="n">showMode</span><span class="p">,</span> <span class="n">showMean</span><span class="p">,</span>
                           <span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="p">,</span> <span class="n">showSingle</span><span class="p">,</span> <span class="n">singleType</span><span class="p">,</span>
                           <span class="n">min_stations</span><span class="p">,</span> <span class="n">rank_by</span><span class="p">,</span> <span class="n">processesPSD</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">timespan</span><span class="p">,</span>
                           <span class="n">dcADF_win_size</span><span class="p">,</span> <span class="n">dcADF_threshold</span><span class="p">,</span> <span class="n">dcADF_pval_thresh</span><span class="p">,</span> <span class="n">dcADF_use_thresh</span><span class="p">,</span>
                           <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">dcExpThresholdHour</span><span class="p">,</span> <span class="n">dcLinThresholdHour</span><span class="p">,</span>
                           <span class="n">byHourOn</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal function that callPycheron calls. This does the majority of the processing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">st_sta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">julday</span><span class="p">)</span>
    <span class="c1"># split trace into time range</span>
    <span class="k">if</span> <span class="n">startdate</span> <span class="ow">and</span> <span class="n">enddate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">starttime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">startdate</span><span class="p">)</span>
        <span class="n">endtime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">enddate</span><span class="p">)</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">)</span>

    <span class="c1"># merges traces needed for crossCorr and corrMetric</span>
    <span class="n">stM</span> <span class="o">=</span> <span class="n">st_sta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">stM</span> <span class="o">=</span> <span class="n">stM</span><span class="o">.</span><span class="n">merge</span><span class="p">()</span>

    <span class="c1"># getting snclq for network and station</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">snclq</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
    <span class="n">snclq</span> <span class="o">=</span> <span class="n">snclq</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="c1"># network dir</span>
    <span class="n">network</span> <span class="o">=</span> <span class="n">snclq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">net_dir</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">network</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">net_dir</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">net_dir</span><span class="p">)</span>

    <span class="c1"># station dir</span>
    <span class="n">station</span> <span class="o">=</span> <span class="n">snclq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sta_dir</span> <span class="o">=</span> <span class="n">net_dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">station</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">sta_dir</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">sta_dir</span><span class="p">)</span>

    <span class="c1"># channel dirs</span>
    <span class="n">chans</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)):</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">snclq</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="n">getChannelName</span><span class="p">(</span><span class="n">snclq</span><span class="p">)</span>
        <span class="n">chans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>

    <span class="c1"># get unique channels from stream</span>
    <span class="n">un_chans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">chans</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beginning Metric Calculations for &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span> <span class="o">+</span> <span class="s1">&#39; Jul Date: &#39;</span> <span class="o">+</span> <span class="n">date</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
    <span class="c1"># creating PSD folder for Station</span>

    <span class="c1"># # ----------------------psdMetric---------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcPsds</span><span class="p">:</span>
        <span class="n">st_psd</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">_psd_wrapper</span><span class="p">(</span><span class="n">st_psd</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span>
                     <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span>
                     <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                     <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span> <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span>
                     <span class="n">processesPSD</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">database</span><span class="p">)</span>

    <span class="c1"># # ----------------------basicStatsMetric--------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcBasic</span><span class="p">:</span>
        <span class="n">st_basic</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_basic</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_basic_stats_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="n">st_basic</span><span class="p">,</span> <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span> <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="p">,</span>
            <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_basic</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------correlationMetric-------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcCorr</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># needed otherwise Process will think st object a mappable list.</span>
        <span class="n">t_corr</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_corr_wrapper</span><span class="p">,</span>
                         <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">stM</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_corr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------crossCorrMetric---------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcCrossCorr</span><span class="p">:</span>
        <span class="n">st_cross</span> <span class="o">=</span> <span class="n">stM</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_cross</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_cross_corr_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">stM</span><span class="p">,</span>
                                                            <span class="n">freqmin</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span> <span class="n">filt</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span>
                                                            <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span>
                                                            <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_cross</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------DCOffSetTimesMetric-----------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcDcOffset</span><span class="p">:</span>
        <span class="n">st_offset</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_offset</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_offset_wrapper</span><span class="p">,</span>
                           <span class="n">args</span><span class="o">=</span><span class="p">(</span>
                               <span class="n">st_offset</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                               <span class="n">network</span><span class="p">,</span>
                               <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_offset</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------gapMetric---------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcGap</span><span class="p">:</span>
        <span class="n">st_gap</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_gap</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_gap_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="n">st_gap</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">separateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span>
            <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>  <span class="c1"># calculating metric</span>
        <span class="n">t_gap</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------repeatedAmplitude-------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcAmp</span><span class="p">:</span>
        <span class="n">st_amp</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_amp</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_rep_amp_wrapper</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">st_amp</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
                              <span class="n">database</span><span class="p">))</span>
        <span class="n">t_amp</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------snrMetric---------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcSNR</span><span class="p">:</span>
        <span class="n">st_snr</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_snr</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_snr_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="n">st_snr</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span> <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span>
            <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_snr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------sohMetric---------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcSOH</span><span class="p">:</span>
        <span class="c1"># creating temp MSEED file because Obspy function used within sohMetric, requires actual file, not St object</span>

        <span class="n">t_soh</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_soh_wrapper</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                              <span class="n">database</span><span class="p">))</span>
        <span class="n">t_soh</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------staltaMetric------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcStalta</span><span class="p">:</span>
        <span class="n">st_stalta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_stalta</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_stalta_wrapper</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="n">st_stalta</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span> <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
            <span class="n">fortran</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_stalta</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------transferFunctionMetric--------------------------------</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcTransfer</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># needed otherwise Process will think st object a mappable list.</span>
        <span class="n">st_trans</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_transfer</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_transfer_wrapper</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">(</span>
                                 <span class="n">st_trans</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_transfer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------spikesMetric------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcSpikes</span><span class="p">:</span>
        <span class="n">st_spikes</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_spikes</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_spikes_wrapper</span><span class="p">,</span>
                           <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">st_spikes</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span> <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span>
                                 <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span>
                                 <span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_spikes</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------deadChannel-------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcAllDeadChan</span><span class="p">:</span>
        <span class="c1"># deadChannelMetric</span>
        <span class="n">detrend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># defualt value for DC</span>
        <span class="n">demean</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># defualt value for DC</span>
        <span class="n">taper</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># defualt value for DC</span>
        <span class="n">st_dc</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_dc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_dead_channel_wrapper</span><span class="p">,</span>
                       <span class="n">args</span><span class="o">=</span><span class="p">(</span>
                           <span class="n">st_dc</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">detrend</span><span class="p">,</span> <span class="n">demean</span><span class="p">,</span> <span class="n">taper</span><span class="p">))</span>
        <span class="n">t_dc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="c1"># deadChanADFMetric</span>
        <span class="c1"># t_dc.join()</span>
        <span class="c1"># st_dcADF = st.copy()</span>
        <span class="c1"># t_dc = Process(target=_dead_channelADF_wrapper,</span>
        <span class="c1">#                   args=(st_dcADF, network, station, logger, dcADF_win_size,</span>
        <span class="c1">#                         dcADF_pval_thresh, dcADF_threshold, generateMasks, masksByTime, dcADF_use_thresh,</span>
        <span class="c1">#                         database))</span>
        <span class="c1"># t_dc.start()</span>

        <span class="c1"># deadChanMeanMetric</span>
        <span class="n">t_dc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">st_dcM</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">t_dc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_dead_channelMean_wrapper</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">st_dcM</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">dcMean_win_size</span><span class="p">,</span> <span class="n">dcMean_thresh</span><span class="p">,</span>
                              <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="p">))</span>
        <span class="n">t_dc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># # ----------------------calibration-------------------------------------------</span>
    <span class="k">if</span> <span class="n">calcAll</span> <span class="ow">or</span> <span class="n">calcCal</span><span class="p">:</span>
        <span class="n">st_cal</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">_calibration_wrapper</span><span class="p">(</span><span class="n">st_cal</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">cal_metric_store</span><span class="p">,</span> <span class="n">database</span><span class="p">)</span>

    <span class="c1"># # ----------------------plots--------------------------------</span>

    <span class="k">if</span> <span class="n">plots</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">calcAll</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">t_amp</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_basic</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_gap</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_snr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_stalta</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_soh</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_dc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_spikes</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_offset</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t_transfer</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
                    <span class="n">t_transfer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t_cross</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
                    <span class="n">t_cross</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t_corr</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
                    <span class="n">t_corr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">elif</span> <span class="n">calcAll</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">calcAmp</span><span class="p">:</span>
                <span class="n">t_amp</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcBasic</span><span class="p">:</span>
                <span class="n">t_basic</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcDcOffset</span><span class="p">:</span>
                <span class="n">t_offset</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcGap</span><span class="p">:</span>
                <span class="n">t_gap</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSNR</span><span class="p">:</span>
                <span class="n">t_snr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcStalta</span><span class="p">:</span>
                <span class="n">t_stalta</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSOH</span><span class="p">:</span>
                <span class="n">t_soh</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcAllDeadChan</span><span class="p">:</span>
                <span class="n">t_dc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcTransfer</span><span class="p">:</span>
                <span class="n">t_transfer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSpikes</span><span class="p">:</span>
                <span class="n">t_spikes</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plotting &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span> <span class="o">+</span> <span class="s1">&#39; Jul Date: &#39;</span> <span class="o">+</span> <span class="n">date</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
        <span class="c1"># st_plot = st.copy()</span>

        <span class="n">dailyPdfplots</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">pdfModel</span><span class="p">,</span> <span class="n">sta_dir</span> <span class="o">+</span> <span class="s1">&#39;/dailyPDFgrid&#39;</span><span class="p">,</span> <span class="n">sta_dir</span> <span class="o">+</span> <span class="s1">&#39;/dailyPDFline&#39;</span><span class="p">,</span> <span class="n">per_arr</span><span class="p">,</span>
                      <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished PDFgrid and Line plots: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>

        <span class="c1"># st_noisePlot = st.copy()</span>
        <span class="n">stationNoiseModel</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="n">sta_dir</span> <span class="o">+</span> <span class="s2">&quot;/stationNoiseModel.png&quot;</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
                          <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;Finished stationNoisePlot: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span>

        <span class="n">psdPlot</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;psd&#39;</span><span class="p">,</span> <span class="n">f_name</span><span class="o">=</span><span class="n">sta_dir</span> <span class="o">+</span> <span class="s1">&#39;/psdPlot&#39;</span><span class="p">,</span> <span class="n">showNoiseModel</span><span class="o">=</span><span class="n">showNoiseModel</span><span class="p">,</span>
                <span class="n">showMaxMin</span><span class="o">=</span><span class="n">showMaxMin</span><span class="p">,</span>
                <span class="n">showMode</span><span class="o">=</span><span class="n">showMode</span><span class="p">,</span>
                <span class="n">showMean</span><span class="o">=</span><span class="n">showMean</span><span class="p">,</span>
                <span class="n">showMedian</span><span class="o">=</span><span class="n">showMedian</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="o">=</span><span class="n">showEnvelope</span><span class="p">,</span> <span class="n">envelopeType</span><span class="o">=</span><span class="n">envelopeType</span><span class="p">,</span>
                <span class="n">showSingle</span><span class="o">=</span><span class="n">showSingle</span><span class="p">,</span>
                <span class="n">singleType</span><span class="o">=</span><span class="n">singleType</span><span class="p">,</span>
                <span class="n">pcolor</span><span class="o">=</span><span class="n">pqlx</span><span class="p">,</span>
                <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
                <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;Finished psdPlot: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span>

        <span class="n">psdPlot</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">f_name</span><span class="o">=</span><span class="n">sta_dir</span> <span class="o">+</span> <span class="s1">&#39;/pdfPlot&#39;</span><span class="p">,</span> <span class="n">showNoiseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">showMaxMin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">showMode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">showMean</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">showMedian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showEnvelope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">envelopeType</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showSingle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">singleType</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">pcolor</span><span class="o">=</span><span class="n">pqlx</span><span class="p">,</span>
                <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span> <span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;Finished pdfPlot: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span>

        <span class="c1"># Station ranking plots</span>
        <span class="c1"># try:</span>
        <span class="c1">#     if len(os.listdir(net_dir)) &gt;= min_stations:</span>
        <span class="c1">#         if all([os.path.isdir(i) for i in os.listdir(net_dir)]):</span>
        <span class="c1">#             if all([len(i) == 3 or len(i) == 4 for i in os.listdir(net_dir)]):</span>
        <span class="c1">#                 pycheronStationRankingPlot(net_dir, pdfModel, rank_by)</span>
        <span class="c1">#                 print &#39;Finished Network Ranking Plot&#39;</span>
        <span class="c1"># except ValueError:</span>
        <span class="c1">#     pass</span>

        <span class="c1"># moving files into correct folders</span>
        <span class="c1"># for fname in os.listdir(sta_dir):</span>
        <span class="c1">#     for j in un_chans:</span>
        <span class="c1">#         if fname.endswith(j + &#39;.png&#39;):</span>
        <span class="c1">#             shutil.move(sta_dir + &#39;/&#39; + fname, sta_dir + &#39;/&#39; + j + &#39;/&#39; + fname)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished Metric Calculations for &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if calcAll is false and calculating individual metrics, some processes may not be up</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">calcAll</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">calcAmp</span><span class="p">:</span>
                <span class="n">t_amp</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcBasic</span><span class="p">:</span>
                <span class="n">t_basic</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcDcOffset</span><span class="p">:</span>
                <span class="n">t_offset</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcGap</span><span class="p">:</span>
                <span class="n">t_gap</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSNR</span><span class="p">:</span>
                <span class="n">t_snr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcStalta</span><span class="p">:</span>
                <span class="n">t_stalta</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSOH</span><span class="p">:</span>
                <span class="n">t_soh</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcAllDeadChan</span><span class="p">:</span>
                <span class="n">t_dc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcTransfer</span><span class="p">:</span>
                <span class="n">t_transfer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">calcSpikes</span><span class="p">:</span>
                <span class="n">t_spikes</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_amp</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_basic</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_gap</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_snr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_stalta</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_soh</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_dc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_spikes</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_offset</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_transfer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_cross</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">t_corr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="c1"># remove tmp MSEED file needed for SOH</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished Metric Calculations for &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------&quot;</span><span class="p">)</span>

<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Metric Wrapper Codes</span>
<span class="c1"># -----------------------------------------------------------------------------</span>

<span class="k">def</span> <span class="nf">_psd_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="p">,</span>
                 <span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">maskByTimes</span><span class="p">,</span> <span class="n">dcExpThreshold</span><span class="p">,</span> <span class="n">pctBelowNoiseThreshold</span><span class="p">,</span>
                 <span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                 <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="p">,</span> <span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span> <span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span>
                 <span class="n">processes</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">byHourOn</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for psdMetric</span>

<span class="sd">    If results are returned, 3 files (per channel) are created and saved to a Stream&#39;s channel dir. In addition, psds</span>
<span class="sd">    are saved in .npy files to be used later in plotting or other calculations, so psds wont have to be calculated again</span>

<span class="sd">    Output Metric filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/psdMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    Output Corrected PSD filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/corrected_psds_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    Output PDF filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/pdfs_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    Out PSD folder: &lt;network_dir&gt;/&lt;station_dir&gt;/PSDS</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calculating PSDS. This could take a while...&quot;</span><span class="p">)</span>
    <span class="c1"># calculating psdMetric</span>
    <span class="n">psds</span> <span class="o">=</span> <span class="n">psdMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">expLoPeriod</span><span class="o">=</span><span class="n">expLoPeriod</span><span class="p">,</span> <span class="n">expHiPeriod</span><span class="o">=</span><span class="n">expHiPeriod</span><span class="p">,</span> <span class="n">linLoPeriod</span><span class="o">=</span><span class="n">linLoPeriod</span><span class="p">,</span>
                     <span class="n">linHiPeriod</span><span class="o">=</span><span class="n">linHiPeriod</span><span class="p">,</span> <span class="n">evalresp</span><span class="o">=</span><span class="n">evalresp</span><span class="p">,</span>
                     <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">maskByTimes</span><span class="p">,</span> <span class="n">dcExpThreshold</span><span class="o">=</span><span class="n">dcExpThreshold</span><span class="p">,</span>
                     <span class="n">pctBelowNoiseThreshold</span><span class="o">=</span><span class="n">pctBelowNoiseThreshold</span><span class="p">,</span>
                     <span class="n">pctAboveNoiseThreshold</span><span class="o">=</span><span class="n">pctAboveNoiseThreshold</span><span class="p">,</span>
                     <span class="n">rmsThreshold</span><span class="o">=</span><span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">dcLinThreshold</span><span class="o">=</span><span class="n">dcLinThreshold</span><span class="p">,</span> <span class="n">num_gaps</span><span class="o">=</span><span class="n">num_gaps</span><span class="p">,</span>
                     <span class="n">pctBelowNoiseThresholdRESP</span><span class="o">=</span><span class="n">pctBelowNoiseThresholdRESP</span><span class="p">,</span>
                     <span class="n">pctAboveNoiseThresholdRESP</span><span class="o">=</span><span class="n">pctAboveNoiseThresholdRESP</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="n">processes</span><span class="p">,</span>
                     <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="o">=</span><span class="n">fortran</span><span class="p">,</span> <span class="n">byHourOn</span><span class="o">=</span><span class="n">byHourOn</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># if psds returned</span>
    <span class="k">if</span> <span class="n">psds</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished psdMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished psdMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): No results returned for psdMetric()... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): No results returned for psdMetric()... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_basic_stats_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="p">,</span> <span class="n">minThreshold</span><span class="p">,</span> <span class="n">medianThreshold</span><span class="p">,</span> <span class="n">meanThreshold</span><span class="p">,</span>
                         <span class="n">varianceThreshold</span><span class="p">,</span>
                         <span class="n">stdThreshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                         <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper code for basicStatsMetric</span>

<span class="sd">    If a result is returned from basicStatsMetric, a CSV file is written out to the Stream&#39;s channel folder</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/crossCorrMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate basicStats</span>
    <span class="n">basic_stats</span> <span class="o">=</span> <span class="n">basicStatsMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">rmsThreshold</span><span class="o">=</span><span class="n">rmsThreshold</span><span class="p">,</span> <span class="n">maxThreshold</span><span class="o">=</span><span class="n">maxThreshold</span><span class="p">,</span>
                                   <span class="n">minThreshold</span><span class="o">=</span><span class="n">minThreshold</span><span class="p">,</span>
                                   <span class="n">medianThreshold</span><span class="o">=</span><span class="n">medianThreshold</span><span class="p">,</span>
                                   <span class="n">meanThreshold</span><span class="o">=</span><span class="n">meanThreshold</span><span class="p">,</span> <span class="n">varianceThreshold</span><span class="o">=</span><span class="n">varianceThreshold</span><span class="p">,</span>
                                   <span class="n">stdThreshold</span><span class="o">=</span><span class="n">stdThreshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">masksByTime</span><span class="p">,</span>
                                   <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">basic_stats</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished basicStatsMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished basicStatsMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if basicStats does not return anything</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): basicStatsMetric - No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): basicStatsMetric - No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_corr_wrapper</span><span class="p">(</span><span class="n">stM</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for correlationMetric.</span>

<span class="sd">    If a result is returned from correlationMetric, a CSV file is written out to the Stream&#39;s station folder</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/correlationMetric_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># must have more than 2 traces in stream.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stM</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># calculating metric</span>
        <span class="n">corrMetric</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># TODO: Make sure this matches all possible combinations, because stM might not be in order</span>
        <span class="c1"># loop through stream, get trace [i] and trace [i+1]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stM</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="n">stM</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tr2</span> <span class="o">=</span> <span class="n">stM</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">corrMetric</span> <span class="o">=</span> <span class="n">correlationMetric</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">)</span>
            <span class="c1"># if d returns result, add to list</span>

        <span class="c1"># if list contains results</span>
        <span class="k">if</span> <span class="n">corrMetric</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished correlationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished correlationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): correlationMetric - No matching Traces... Skipping&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): correlationMetric - No matching Traces... Skipping&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if len is &lt; 2</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): correlationMetric - Not enought traces in Stream... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): correlationMetric - Not enought traces in Stream... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_cross_corr_wrapper</span><span class="p">(</span><span class="n">stM</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="p">,</span> <span class="n">filt</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="p">,</span> <span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="p">,</span>
                        <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for crossCorrelationMetric.</span>

<span class="sd">    If a result is returned from crossCorrelationMetric, a CSV file is written out to the Stream&#39;s station folder</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/crossCorrMetric_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># must have two or more traces in stream</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stM</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">freqmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">freqmin</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
        <span class="c1"># calculating metric</span>
        <span class="n">crossCorr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># TODO: Make sure this matches all possible combinations, because stM might not be in order</span>
        <span class="c1"># loop through stream, get trace [i] and trace [i+1]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stM</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="n">stM</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tr2</span> <span class="o">=</span> <span class="n">stM</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1"># calc corssCorrMetric</span>
            <span class="n">crossCorr</span> <span class="o">=</span> <span class="n">crossCorrMetric</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">,</span> <span class="n">maxLagSecs</span><span class="o">=</span><span class="n">maxLagSecs</span><span class="p">,</span> <span class="n">filt</span><span class="o">=</span><span class="n">filt</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">freqmin</span><span class="p">,</span>
                                        <span class="n">freqmax</span><span class="o">=</span><span class="n">freqmax</span><span class="p">,</span>
                                        <span class="n">corners</span><span class="o">=</span><span class="n">corners</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="n">zerophase</span><span class="p">,</span>
                                        <span class="n">maxorder</span><span class="o">=</span><span class="n">maxorder</span><span class="p">,</span> <span class="n">ba</span><span class="o">=</span><span class="n">ba</span><span class="p">,</span> <span class="n">freq_passband</span><span class="o">=</span><span class="n">freq_passband</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
                                        <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

        <span class="c1"># if results in list</span>
        <span class="k">if</span> <span class="n">crossCorr</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished crossCorrMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished crossCorrMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if results are empty, no matching traces to correlate</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): crossCorrMetric - No matching traces... Skipping Metric&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): crossCorrMetric - No matching traces... Skipping Metric&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if len &lt; 2, not enough traces for metric</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): crossCorrMetric Not enought traces in Stream&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): crossCorrMetric Not enought traces in Stream&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_offset_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">windowSecs</span><span class="p">,</span> <span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span>
                    <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for DCOffSetTimesMetric.</span>

<span class="sd">    If a result is returned from DCOffSetTimesMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/DCOffSetTimesMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculating dc offsets</span>
    <span class="n">offset_times</span> <span class="o">=</span> <span class="n">DCOffSetTimesMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">masksByTime</span><span class="p">,</span> <span class="n">windowSecs</span><span class="o">=</span><span class="n">windowSecs</span><span class="p">,</span>
                                       <span class="n">incrementSecs</span><span class="o">=</span><span class="n">incrementSecs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
                                       <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># if DCOffSetMetric returns results</span>
    <span class="k">if</span> <span class="n">offset_times</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished DCOffset for:&quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished DCOffset for:&quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): DCOffSetTimesMetric: No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): DCOffSetTimesMetric: No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_gap_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">separateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                 <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for gapMetric</span>

<span class="sd">    If a result is returned from gapMetric, two CSV files are written. 1. A summary file for all the stations</span>
<span class="sd">    located in the Station folder, and 2. A values file, which contains the specific values and information about each</span>
<span class="sd">    gap, found in each respective channel folder. If there are not gaps a channel gap file will not be generated, only</span>
<span class="sd">    the summary file will be.</span>

<span class="sd">    Output summary filename: &lt;station_directory&gt;/gapsMetricSummary_&lt;date&gt;.csv</span>
<span class="sd">    Output values filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/gapsMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate gaps metric.</span>
    <span class="c1"># gaps - list of individual gaps information</span>
    <span class="c1"># sum - summary information for station</span>
    <span class="n">gapMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">separateMasks</span><span class="o">=</span><span class="n">separateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">masksByTime</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
              <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished gapMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished gapMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_rep_amp_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">minRep</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for repeatedAmplitudeMetric</span>

<span class="sd">    If a result is returned from repeatedAmplitude Metric, two CSV files are written. 1. A summary file for all the stations</span>
<span class="sd">    located in the Station folder, and 2. A values file, which contains the specific values and information about each</span>
<span class="sd">    repeated amplitude, found in each respective channel folder. If there are no repeated amplitudes, a value file</span>
<span class="sd">    will not be generated</span>

<span class="sd">    Output summary filename: &lt;station_directory&gt;/repeatedAmplitudeSummary_&lt;date&gt;.csv</span>
<span class="sd">    Output values filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/repeatedAmplitudeValues_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">rep_amp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># for each trace in stream, calculate repeatedAmplitudeMetric and append to list</span>

    <span class="n">rep_amp</span> <span class="o">=</span> <span class="n">repeatedAmplitudeMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">minRep</span><span class="o">=</span><span class="n">minRep</span><span class="p">,</span> <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
                                      <span class="n">fortran</span><span class="o">=</span><span class="n">fortran</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="c1"># if results returned</span>
    <span class="k">if</span> <span class="n">rep_amp</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished repeatedAmplitude for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished repeatedAmplitude for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if nothing returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): repeatedAmplitudeMetric: No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): repeatedAmplitudeMetric: No results returned... Skipping&quot;</span><span class="p">)</span>
    <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;callPycheron(): repeatedAmplitudeMetric: Time in minutes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_snr_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">algorithmSNR</span><span class="p">,</span> <span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span>
                 <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for snrMetric.</span>

<span class="sd">    If a result is returned from snrMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/snrMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculating snrMetric</span>
    <span class="n">snr</span> <span class="o">=</span> <span class="n">snrMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithmSNR</span><span class="p">,</span> <span class="n">windowSecs</span><span class="o">=</span><span class="n">windowSecsSNR</span><span class="p">,</span> <span class="n">snrThreshold</span><span class="o">=</span><span class="n">snrThreshold</span><span class="p">,</span>
                    <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">masksByTime</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># if snrMetric returns a result, loop through unique channels and create/open a csv file to write out to.</span>
    <span class="k">if</span> <span class="n">snr</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished snrMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished snrMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): snrMetric - No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="c1"># if nothing is returned</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): snrMetric - No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_soh_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for sohMetric.</span>

<span class="sd">    If a result is returned from sohMetric, a CSV file is written out to the Stream&#39;s respective station</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/sohMetric_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate sohMetric</span>
    <span class="n">soh</span> <span class="o">=</span> <span class="n">sohMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">data_quality</span><span class="o">=</span><span class="n">data_quality</span><span class="p">,</span> <span class="n">activity</span><span class="o">=</span><span class="n">activity</span><span class="p">,</span> <span class="n">io_clock</span><span class="o">=</span><span class="n">io_clock</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
                    <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># if soh returns result, create/open a csv file to write out to.</span>
    <span class="k">if</span> <span class="n">soh</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished sohMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished sohMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): sohMetric returned None&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;callPycheron(): No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_stalta_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="p">,</span> <span class="n">algorithmSTA</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                    <span class="n">fortran</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for staltaMetric.</span>

<span class="sd">    If a result is returned from staltaMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/staltaMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># calculate stalta metric</span>
    <span class="n">stalta</span> <span class="o">=</span> <span class="n">staltaMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">staSecs</span><span class="o">=</span><span class="n">staSecs</span><span class="p">,</span> <span class="n">ltaSecs</span><span class="o">=</span><span class="n">ltaSecs</span><span class="p">,</span> <span class="n">increment</span><span class="o">=</span><span class="n">increment</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithmSTA</span><span class="p">,</span>
                          <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="o">=</span><span class="n">fortran</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># if staltaMetric returns a result, loop through unique channels and create/open a csv file to write out to.</span>
    <span class="k">if</span> <span class="n">stalta</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished staltaMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished staltaMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): staltaMetric: No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): staltaMetric: No results returned... Skipping&quot;</span><span class="p">)</span>
    <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;callPycheron(): staltaMetric: Time in minutes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_transfer_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for transferFunctionMetric.</span>

<span class="sd">    If a stream have &gt;= 2 traces, and transferFunction returns a results, a CSV file is written out to the Stream&#39;s</span>
<span class="sd">    respective channel folder</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/transferFunctionMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># Needs &gt;= 2 traces in stream too compare for metric</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">transMetric</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop through stream, get stream [i] and stream  [i + 1]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">tr1</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tr2</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">transMetric</span> <span class="o">=</span> <span class="n">transferFunctionMetric</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

        <span class="c1"># If result is returned, loop through unique channels and create/open CSV file.</span>
        <span class="k">if</span> <span class="n">transMetric</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished transferFunctionMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished transferFunctionMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if result returns nothing</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): transferFunctionMetric: No Matching Traces... Skipping Metric&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): transferFunctionMetric: No Matching Traces... Skipping Metric&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): transferFunctionMetric: Not enought traces in Stream&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): transferFunctionMetric: Not enought traces in Stream&quot;</span><span class="p">)</span>
    <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;callPycheron(): transferFunctionMetric: Time in minutes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_spikes_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">windowSize</span><span class="p">,</span> <span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="p">,</span> <span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">processesSpikes</span><span class="p">,</span>
                    <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for spikesMetric.</span>

<span class="sd">    If a result is returned from spikesMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: &lt;network_dir&gt;/&lt;station_dir&gt;/&lt;channel_dir&gt;/spikesMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># calculate spikes metric</span>
    <span class="n">spikes</span> <span class="o">=</span> <span class="n">spikesMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">windowSize</span><span class="o">=</span><span class="n">windowSize</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">thresholdSpikes</span><span class="p">,</span> <span class="n">selectivity</span><span class="o">=</span><span class="n">selectivity</span><span class="p">,</span>
                          <span class="n">fixedThreshold</span><span class="o">=</span><span class="n">fixedThreshold</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="n">processesSpikes</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">fortran</span><span class="o">=</span><span class="n">fortran</span><span class="p">,</span>
                          <span class="n">generateMasks</span><span class="o">=</span><span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="o">=</span><span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="c1"># if spikesMetric returns a result, loop through unique channels and create/open a csv file to write out to.</span>
    <span class="k">if</span> <span class="n">spikes</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished spikesMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished spikesMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if nothing is returned from metric</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): spikesMetric: No result returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): spikesMetric: No result returned... Skipping&quot;</span><span class="p">)</span>
    <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;callPycheron(): spikesMetric: Time in minutes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_dead_channel_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">demean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">taper</span><span class="o">=.</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for deadChannelMetric.</span>

<span class="sd">    If a result is returned from deadChannel Metric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: deadChannelMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate deadChannelMetric</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">deadChannelMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># If result is returned, loop through unique channels and create/open CSV file.</span>
    <span class="k">if</span> <span class="n">dc</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChannelMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChannelMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if no results are returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChannelMetric - No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChannelMetric - No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_dead_channelADF_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">pval_threshold</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                             <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">use_thesh</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for deadChanADFMetric.</span>

<span class="sd">    If a result is returned from deadChanADFMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: deadChanADFMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dc</span> <span class="o">=</span> <span class="n">deadChanADFMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">pval_threshold</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">use_thesh</span><span class="p">,</span>
                           <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dc</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChanADFMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChanADFMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if no results are returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChanADFMetric - No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChanADFMetric - No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_dead_channelMean_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span>
                              <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for deadChanADFMetric.</span>

<span class="sd">    If a result is returned from deadChanADFMetric, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: deadChanMeanMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dc</span> <span class="o">=</span> <span class="n">deadChanMean</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">win_size</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">generateMasks</span><span class="p">,</span> <span class="n">masksByTime</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dc</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChanMeanMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished deadChanMeanMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if no results are returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChanMeanMetric - No results returned... Skipping&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): deadChanMeanMetric - No results returned... Skipping&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_calibration_wrapper</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">metric_store</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for calibration metric</span>

<span class="sd">    If a result is returned from calibration, a CSV file is written out to the Stream&#39;s respective channel</span>
<span class="sd">    folder.</span>

<span class="sd">    Output filename: calibrationMetric_&lt;channel&gt;_&lt;date&gt;.csv</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cal</span> <span class="o">=</span> <span class="n">calibrationMetric</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">metric_store</span><span class="o">=</span><span class="n">metric_store</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cal</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished calibrationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished calibrationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if no results are returned</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished calibrationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;callPycheron(): Finished calibrationMetric for: &quot;</span> <span class="o">+</span> <span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">station</span><span class="p">)</span>


<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Main Code</span>
<span class="c1"># -----------------------------------------------------------------------------</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="kn">import</span> <span class="nn">argparse</span>
    <span class="kn">import</span> <span class="nn">yaml</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;callPycheronMetric&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s1">&#39;config_file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Configuration file containing callPycheronMetric params&quot;</span>
    <span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">config_file</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yaml&#39;</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ymlfile</span><span class="p">:</span>
                <span class="n">cfg</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ymlfile</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s2">&quot;Error: config file must be yaml&quot;</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot;Error: No config file&quot;</span>
        <span class="k">return</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;session&#39;</span><span class="p">:</span>
            <span class="n">cfg</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="n">callPycheron</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;output_dir&quot;</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;datatype&quot;</span><span class="p">],</span> <span class="n">calcAll</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcAll&quot;</span><span class="p">],</span> <span class="n">calcPsds</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcPsds&quot;</span><span class="p">],</span> <span class="n">calcBasic</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcBasic&quot;</span><span class="p">],</span>
                 <span class="n">calcCorr</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcCorr&quot;</span><span class="p">],</span>
                 <span class="n">calcCrossCorr</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcCrossCorr&quot;</span><span class="p">],</span>
                 <span class="n">calcGap</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcGap&quot;</span><span class="p">],</span> <span class="n">calcAmp</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcAmp&quot;</span><span class="p">],</span> <span class="n">calcSNR</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcSNR&quot;</span><span class="p">],</span> <span class="n">calcSOH</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcSOH&quot;</span><span class="p">],</span> <span class="n">calcStalta</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcStalta&quot;</span><span class="p">],</span> <span class="n">calcDcOffset</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcDcOffset&quot;</span><span class="p">],</span>
                 <span class="n">calcSpikes</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcSpikes&quot;</span><span class="p">],</span> <span class="n">calcAllDeadChan</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcAllDeadChan&quot;</span><span class="p">],</span> <span class="n">calcTransfer</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcTransfer&quot;</span><span class="p">],</span> <span class="n">calcCal</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;calcCal&quot;</span><span class="p">],</span> <span class="n">network</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;network&quot;</span><span class="p">],</span>
                 <span class="n">station</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">],</span>
                 <span class="n">byDay</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;byDay&quot;</span><span class="p">],</span>
                 <span class="n">startdate</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;startdate&quot;</span><span class="p">],</span> <span class="n">enddate</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;enddate&quot;</span><span class="p">],</span> <span class="n">jul_start</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;jul_start&quot;</span><span class="p">],</span> <span class="n">jul_end</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;jul_end&quot;</span><span class="p">],</span> <span class="n">generateMasks</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;generateMasks&quot;</span><span class="p">],</span>
                 <span class="n">masksByTime</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;masksByTime&quot;</span><span class="p">],</span>
                 <span class="n">rmsThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;rmsThreshold&quot;</span><span class="p">],</span>
                 <span class="n">maxThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;maxThreshold&quot;</span><span class="p">],</span> <span class="n">minThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;minThreshold&quot;</span><span class="p">],</span> <span class="n">medianThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;medianThreshold&quot;</span><span class="p">],</span> <span class="n">meanThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;meanThreshold&quot;</span><span class="p">],</span>
                 <span class="n">varianceThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;varianceThreshold&quot;</span><span class="p">],</span>
                 <span class="n">stdThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;stdThreshold&quot;</span><span class="p">],</span> <span class="n">maxLagSecs</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;maxLagSecs&quot;</span><span class="p">],</span> <span class="n">filt</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;filt&quot;</span><span class="p">],</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;freqmin&quot;</span><span class="p">],</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;freqmax&quot;</span><span class="p">],</span> <span class="n">corners</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;corners&quot;</span><span class="p">],</span>
                 <span class="n">zerophase</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;zerophase&quot;</span><span class="p">],</span> <span class="n">maxorder</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;maxorder&quot;</span><span class="p">],</span> <span class="n">ba</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;ba&quot;</span><span class="p">],</span> <span class="n">freq_passband</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;freq_passband&quot;</span><span class="p">],</span> <span class="n">windowSecs</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;windowSecs&quot;</span><span class="p">],</span>
                 <span class="n">incrementSecs</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;incrementSecs&quot;</span><span class="p">],</span>
                 <span class="n">threshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">],</span> <span class="n">separateMasks</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;separateMasks&quot;</span><span class="p">],</span> <span class="n">completeDay</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;completeDay&quot;</span><span class="p">],</span> <span class="n">expLoPeriod</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;expLoPeriod&quot;</span><span class="p">],</span> <span class="n">expHiPeriod</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;expHiPeriod&quot;</span><span class="p">],</span>
                 <span class="n">linLoPeriod</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;linLoPeriod&quot;</span><span class="p">],</span> <span class="n">linHiPeriod</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;linHiPeriod&quot;</span><span class="p">],</span>
                 <span class="n">evalresp</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;evalresp&quot;</span><span class="p">],</span> <span class="n">dcExpThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcExpThreshold&quot;</span><span class="p">],</span> <span class="n">pctBelowNoiseThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;pctBelowNoiseThreshold&quot;</span><span class="p">],</span> <span class="n">pctAboveNoiseThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;pctAboveNoiseThreshold&quot;</span><span class="p">],</span>
                 <span class="n">dcLinThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcLinThreshold&quot;</span><span class="p">],</span> <span class="n">num_gaps</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;num_gaps&quot;</span><span class="p">],</span> <span class="n">pctBelowNoiseThresholdRESP</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;pctBelowNoiseThresholdRESP&quot;</span><span class="p">],</span>
                 <span class="n">pctAboveNoiseThresholdRESP</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;pctAboveNoiseThresholdRESP&quot;</span><span class="p">],</span> <span class="n">minRep</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;minRep&quot;</span><span class="p">],</span>
                 <span class="n">algorithmSNR</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;algorithmSNR&quot;</span><span class="p">],</span> <span class="n">windowSecsSNR</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;windowSecsSNR&quot;</span><span class="p">],</span> <span class="n">snrThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;snrThreshold&quot;</span><span class="p">],</span> <span class="n">data_quality</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;data_quality&quot;</span><span class="p">],</span> <span class="n">activity</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;activity&quot;</span><span class="p">],</span>
                 <span class="n">io_clock</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;io_clock&quot;</span><span class="p">],</span> <span class="n">windowSize</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;windowSize&quot;</span><span class="p">],</span> <span class="n">thresholdSpikes</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;thresholdSpikes&quot;</span><span class="p">],</span> <span class="n">selectivity</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;selectivity&quot;</span><span class="p">],</span> <span class="n">fixedThreshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;fixedThreshold&quot;</span><span class="p">],</span>
                 <span class="n">staSecs</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;staSecs&quot;</span><span class="p">],</span>
                 <span class="n">ltaSecs</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;ltaSecs&quot;</span><span class="p">],</span> <span class="n">increment</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;increment&quot;</span><span class="p">],</span> <span class="n">algorithmSTA</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;algorithmSTA&quot;</span><span class="p">],</span> <span class="n">plots</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;plots&quot;</span><span class="p">],</span> <span class="n">pdfModel</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;pdfModel&quot;</span><span class="p">],</span> <span class="n">per_arr</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;per_arr&quot;</span><span class="p">],</span>
                 <span class="n">showNoiseModel</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showNoiseModel&quot;</span><span class="p">],</span> <span class="n">showMaxMin</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showMaxMin&quot;</span><span class="p">],</span> <span class="n">showMode</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showMode&quot;</span><span class="p">],</span> <span class="n">showMean</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showMean&quot;</span><span class="p">],</span> <span class="n">showMedian</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showMedian&quot;</span><span class="p">],</span>
                 <span class="n">showEnvelope</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showEnvelope&quot;</span><span class="p">],</span> <span class="n">envelopeType</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;envelopeType&quot;</span><span class="p">],</span> <span class="n">showSingle</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;showSingle&quot;</span><span class="p">],</span> <span class="n">singleType</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;singleType&quot;</span><span class="p">],</span>
                 <span class="n">min_stations</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;min_stations&quot;</span><span class="p">],</span> <span class="n">rank_by</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;rank_by&quot;</span><span class="p">],</span> <span class="n">processesPSD</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;processesPSD&quot;</span><span class="p">],</span> <span class="n">processesSpikes</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;processesSpikes&quot;</span><span class="p">],</span> <span class="n">log</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">],</span>
                 <span class="n">fortran</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;fortran&quot;</span><span class="p">],</span>
                 <span class="n">timespan</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;timespan&quot;</span><span class="p">],</span> <span class="n">dcADF_win_size</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcADF_win_size&quot;</span><span class="p">],</span> <span class="n">dcADF_pval_thresh</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcADF_pval_thresh&quot;</span><span class="p">],</span> <span class="n">dcADF_threshold</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcADF_threshold&quot;</span><span class="p">],</span>
                 <span class="n">dcADF_use_thresh</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcADF_use_thresh&quot;</span><span class="p">],</span>
                 <span class="n">dcMean_win_size</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcMean_win_size&quot;</span><span class="p">],</span> <span class="n">dcMean_thresh</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcMean_thresh&quot;</span><span class="p">],</span> <span class="n">cal_metric_store</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;cal_metric_store&quot;</span><span class="p">],</span> <span class="n">dcExpThresholdHour</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcExpThresholdHour&quot;</span><span class="p">],</span>
                 <span class="n">dcLinThresholdHour</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;dcLinThresholdHour&quot;</span><span class="p">],</span> <span class="n">byHourOn</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;byHourOn&quot;</span><span class="p">],</span> <span class="n">database</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">],</span> <span class="n">session</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;session&quot;</span><span class="p">],</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;overwrite&quot;</span><span class="p">],</span>
                 <span class="n">to_csv</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;to_csv&quot;</span><span class="p">],</span> <span class="n">stationStartAt</span><span class="o">=</span><span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;stationStartAt&quot;</span><span class="p">])</span>

    <span class="n">timestart</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time in minutes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestart</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Jessica Bobeck, Katherine Anderson Aur.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.<br/>
    </p>
  </div>
</footer>
  </body>
</html>